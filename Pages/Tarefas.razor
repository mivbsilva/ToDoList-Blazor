@page "/tarefas" 
<!-- Define o caminho da pÃ¡gina -->
@using System.Collections.Generic
<!-- Ã‰ o namespace que precisamos usar para podermos acessar a classe de List -->

<h1 class="text-2xl font-bold mb-4">ToDoList da Milena</h1> <!-- TÃ­tulo -->

<input @bind="novaTarefa" placeholder="Digite uma nova tarefa" class="border p-2 rounded w-full mb-2" /> <!-- Campo input -->

<button @onclick="AdicionarTarefa" class="bg-blue-500 text-white px-4 py-2 rounded">Adicionar</button> <!-- BotÃ£o para inserir tarefa do input -->

<!-- Iniciando a lista -->
<ul class="mt-4">
    @foreach (var tarefa in tarefas.Select((t, i) => new { Texto = t, Index = i })) 
    {
    <!-- Para cada tarefa na lista de tarefas-->
        <li class="border-b py-2 flex justify-between items-center">
            @if (tarefa.Index == indexDaTarefaEmEdicao)
            {
            <!-- Se o index da tarefa for igual ao index da tarefa passada no indexDaTarefaEmEdicao, entÃ£o vamos editar-->

                <!-- Cria uma input para editar ligado acessar variÃ¡vel string textoDaTarefaEditada -->
                <input @bind="textoDaTarefaEditada" class="border p-2 rounded w-full mr-2" />

                <!-- Cria uma botÃ£o escrito salvar que, quando clicado, chama a funÃ§Ã£o SalvarEdicao -->
                <button @onclick="SalvarEdicao" class="bg-green-500 text-white px-2 py-1 rounded ml-2">Salvar</button>
                <!-- Cria uma botÃ£o escrito cancelar que, quando clicado, chama a funÃ§Ã£o CancelarEdicao -->
                <button @onclick="CancelarEdicao" class="bg-gray-400 text-white px-2 py-1 rounded ml-2">Cancelar</button>
            }
            else
            {
                <!-- Se o index da tarefa for diferente ao index da tarefa passada no indexDaTarefaEmEdicao, entÃ£o nÃ£o vamos fazer nada. Vamos continuar pegando o texto da tarefa-->
                <span>@tarefa.Texto</span>

                <!-- Vamos continuar exibindo o botÃ£o de Editar-->
                <button @onclick="() => EditarTarefa(tarefa.Index)" class="text-blue-500 text-sm ml-2">âœï¸ Editar</button>

                <!-- Cria uma botÃ£o escrito excluir que, quando clicado, chama a funÃ§Ã£o ExcluirTarefa -->
                <button @onclick="() => ExcluirTarefa(tarefa.Index)" class="text-red-500 text-sm ml-2">ğŸ—‘ï¸ Excluir</button>
            }
        </li>
    }
</ul>

@code {
    private string novaTarefa; //Cria a variÃ¡vel novaTarefa que Ã© uma string
    private List<string> tarefas = new(); //Cria a variÃ¡vel tarefas que Ã© uma List de strings

    private int? indexDaTarefaEmEdicao = null; //Cria a variÃ¡vel indexDaTarefaEmEdicao que irÃ¡ guardar o index da tarefa que estou editando int. Pode ser null pelo ?
    private string textoDaTarefaEditada = string.Empty; //Cria a variÃ¡vel textoDaTarefaEditada que irÃ¡ guardar a nova tarefa incluÃ­da no input que Ã© uma string

    //funÃ§Ã£o para adicionar tarefa
    private void AdicionarTarefa() //chamada quando clicamos no botÃ£o Adicionar
    {
        if (!string.IsNullOrWhiteSpace(novaTarefa)) //se a string guardada na nova tarefa nÃ£o for nula ou espaÃ§o em branco, entÃ£o existe uma tarefa preenchida. EntÃ£o:
        {
            tarefas.Add(novaTarefa); //adiciona a nova tarefa na lista tarefas
            novaTarefa = string.Empty; //limpa a variÃ¡vel string novaTarefa
        }
    }

    //funÃ§Ã£o para editar tarefa
    private void EditarTarefa(int index) //chamada quando clicamos no botÃ£o âœï¸ Editar
    {
        indexDaTarefaEmEdicao = index; //sÃ³ vai guardar qual o index da tarefa em ediÃ§Ã£o
        textoDaTarefaEditada = tarefas[index]; // vai guardar o texto string daquele index da lista tarefas
    }

    //funÃ§Ã£o para salvar ediÃ§Ã£o
    private void SalvarEdicao() //chamada quando clicamos no botÃ£o Salvar
    {
        if (indexDaTarefaEmEdicao != null && !string.IsNullOrWhiteSpace(textoDaTarefaEditada)) //se o index da tarefa em ediÃ§Ã£o nÃ£o for nulo e a string do textoDaTarefaEditada nÃ£o for nula ou whitespace, quer dizer que existe item em ediÃ§Ã£o. EntÃ£o:
        {
            tarefas[(int)indexDaTarefaEmEdicao] = textoDaTarefaEditada; //na lista de tarefas, no index da tarefa em ediÃ§Ã£o, vamos colocar o texto da tarefa editada
            indexDaTarefaEmEdicao = null; //vamos limpar o index da tarefa em ediÃ§Ã£o
            textoDaTarefaEditada = string.Empty; //vamos limpar a string do texto da tarefa editada
        }
    }

    //funÃ§Ã£o para cancelar ediÃ§Ã£o
    private void CancelarEdicao() //chamada quando clicamos no botÃ£o Cancelar
    {
        indexDaTarefaEmEdicao = null; //sÃ³ limpa o index da tarefa em ediÃ§Ã£o e nÃ£o faz nada
        textoDaTarefaEditada = string.Empty; //sÃ³ limpa a string da tarefa em ediÃ§Ã£o e nÃ£o faz nada
    }

    // funÃ§Ã£o para excluir tarefa
    private void ExcluirTarefa(int index) //chamada quando clicamos no botÃ£o ExcluirTarefa
    {
        if (index >= 0 && index < tarefas.Count) //se o index for maior ou igual a 0 e o index for menor que a quantidade de itens, entÃ£o:
        {
            tarefas.RemoveAt(index); //sÃ³ remover
        }
    }

}
